シーンの場面が命令
↓
物語全体の流れの把握(lightrag)
    物語の全体像とこれから描くシーンまでの流れ
    戻り値：
    - str
↓
直前のシーンの要約をプロンプトに取り込む
    1. 直前のシーンのファイルディレクトリを探す
    2. 直前のシーンのファイルディレクトリを取得し、テキストを取り出す
    3. 直前のシーンの要約を作成し返却
    引数:
    戻り値：
    - str
↓
キャラクター・世界観設定Rag
    1. 直前のシーン及び命令から、これから描くシーンで登場する登場人物を一覧化
    2. 登場人物の情報をプロンプトに組み込む
    3. 描画に必要な世界観の設定が必要であれば、それもRagにアクセスして取り込む
    引数:
    - setting :
        - query: str
        - reason: str | None (世界観設定の時のみ、なぜ必要かの説明)
    戻り値：
    - str
↓
描写
    1. 直前のシーンの要約
    2. 設定情報
    3. 物語の全体像と描くシーンの内容(命令)、そのシーンの立ち位置(起承転結等)
    引数:
    - before_scene: str
    - setting: str
    - story: str
    - output_path: Path
    戻り値:
    - void(fileに書き込み)
↓
TextlintFB(機械校正)
    1. 出力されたテキストがおかしくないか機械的にチェック
    2. if: エラーがあった場合は、その内容を描画エージェントに通達する
    3. if: エラーがない場合は、次の作業へ
    引数:
    - file_path: str
    戻り値:
    - dict[result_flg: bool, error: str|None]
↓
描写
    1. 直前のシーンの要約
    2. 設定情報
    3. 物語の全体像と描くシーンの内容(命令)、そのシーンの立ち位置(起承転結等)
    (1, 2, 3はメモリ機能で)
    4. if errorがある => エラーメッセージの内容を元に修正。
    引数:
    - before_scene: str
    - setting: str
    - story: str
    - output_path: Path
    戻り値:
    - void(fileに書き込み)
↓
ユーザ評価orエージェント評価
    1. 出力されたシーンが読者視点でおかしくないかチェック
        -
    引数:
    - file_path: str
    - 直前のシーン: Path
    戻り値:
    - dict[result_flg: bool, error: str|None]
↓
描写
4. if errorがある => エラーメッセージの内容を元に修正。
    引数:
    - before_scene: str
    - setting: str
    - story: str
    - output_path: Path
    戻り値:
    - void(fileに書き込み)
↓
完成

画面上の操作ユースケース
　キャラクターの設定フォルダを指定して、Rag作成を実行できる
　MCP経由でlightrag_mcp_rag_serverにアクセスし、

openai agent sdkを用います。
小説執筆を行うエージェントを作成したいです。
小説の詳細な設定はローカル文書としてsettingディレクトリ以下にまとめられています。
またtextlintのmcp serverを用い予定です。
小説を一気に出力するのではなく、細かいシーンごとの内容をプロンプトとして受け取り、そのシーンを生成します。
そのシーンに必要なキャラクター設定などを描画
